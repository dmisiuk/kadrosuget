<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <title>Инфокадр: Панель администратора</title>
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/all.io.js"></script>
    <script>
        var rpcUrl = "admin/jsonrpc";
        var methods = [
            "createFilm",
            "readFilm",
            "createTrailer",
            "readTrailer"
        ];

        var rpc = new zebra.io.JRPC(rpcUrl, methods);

        rpc.print = function (jo) {
            return JSON.stringify(jo, null, '\t');
        }
    </script>

    <script>
        var showAddFilm = function () {
            console.log("show add film");
            $("ul#path").empty();
            $("ul#path").append(
                    $("<li>").append(
                            $("<a>").attr("href", "javascript: showAllFilms()").append("Все фильмы")
                    ).append(
                            $("<span>").attr("class", "divider").append("/")
                    )
            ).append(
                    $("<li>").attr("class", "active").append("Добавить фильм")

            )
            $("section#show").empty();
            $("section#show").append(
                    $("<h3>").append("Добавление фильма")
            ).append(
                    $("<form>").attr("class", "form-horizontal").append(
                            $("<div>").attr("class", "control-group").append(
                                    $("<label>").attr("class", "control-label").attr("for", "rusName").append("Название фильма на русском")
                            ).append(
                                    $("<div>").attr("class", "controls").append(
                                            $("<input>").attr("type", "text").attr("id", "rusName").attr("placeholder", "русское название")
                                    )
                            )
                    ).append(
                            $("<div>").attr("class", "control-group").append(
                                    $("<label>").attr("class", "control-label").attr("for", "engName").append("Название фильма на английском")
                            ).append(
                                    $("<div>").attr("class", "controls").append(
                                            $("<input>").attr("type", "text").attr("id", "engName").attr("placeholder", "english name")
                                    )
                            )
                    ).append(
                            $("<div>").attr("class", "control-group").append(
                                    $("<div>").attr("class", "controls").append(
                                            $("<button>").attr("type", "button").attr("class", "btn").attr("onclick", "createFilm()").append("Добавить фильм")
                                    )
                            )
                    )
            )
        }

        var showAllFilms = function () {
            console.log("show all films");

            films = [
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},
                {engName:"hobbit", rusName:"Хоббит", added:new Date()},

                {engName:"hobbit", rusName:"Хоббит", added:new Date()}
            ]

            $("ul#path").empty();
            $("ul#path").append(
                    $("<li>").attr("class", "active").append("Все фильмы")
            )

            $("section#show").empty();
            $("section#show").append(
                    $("<h3>").append("Все фильмы")
            ).append(
                    $("<table>").attr("class", "table table-bordered table-hover table-condensed").append(
                    ).append().append(
                            $("<thead>").append(
                                    $("<tr>").append(
                                            $("<th>").append("Русское имя")
                                    ).append(
                                            $("<th>").append("English name")
                                    ).append(
                                            $("<th>").append("Добавлен")
                                    ).append(
                                            $("<th>").append("Действия")
                                    )
                            )
                    ).append(
                            $("<tbody>").attr("id", "filmlist")
                    )
            )

            createFilmTable(films);
        }

        var createFilmTable = function (films) {
            $("tbody#filmlist").empty();
            for (i = 0; i < films.length; i++) {
                film = films[i];
                $("tbody#filmlist").append(
                        $("<tr>").append(
                                $("<td>").append(film.rusName)
                        ).append(
                                $("<td>").append(film.engName)
                        ).append(
                                $("<td>").append(film.added.toLocaleDateString().toString() + ", " + film.added.toLocaleTimeString())
                        ).append(
                                $("<td>").append("----")
                        )
                )
            }
        }

        var createFilm = function () {
            console.log("create film")
            engName = $("input#engName").val();
            rusName = $("input#rusName").val();
            film = {rusName:rusName, engName:engName};
            console.log(film);
        }

        $(document).ready(
                function () {
                    showAllFilms();
                    $(".alert").alert()
                }
        )
    </script>
</head>
<body>


<div class="container">
    <div class="navbar navbar-static-top ">
        <div class="navbar-inner">
            <a class="brand" href="/">Infokadr</a>
            <ul class="nav">
                <li class="active">
                    <button type="button" class="btn btn-link" onclick="showAllFilms()">Все фильмы</button>
                <li>
                    <button type="button" class="btn btn-link" onclick="showAddFilm()">Добавить фильм</button>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="#">Выйти</a></li>
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="span12">

            <section id="breadcrumb">
                <ul class="breadcrumb" id="path">
                    <li><a href="#" class="active">Все фильмы</a></li>
                </ul>
            </section>
            <hr>
            <div class="alert" id="flash">
                <button type="button" class="close" data-dismiss="alert">×</button>
                <strong>Warning!</strong> Best check yo self, you're not looking too good.
            </div>
            <section id="show">
            </section>
        </div>
    </div>

</div>

</body>
</html>